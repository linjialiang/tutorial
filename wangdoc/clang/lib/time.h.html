<!DOCTYPE html><html lang="zh-CN" prefix="og: http://ogp.me/ns#"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>time.h - C 语言教程 - 网道</title><!-- link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" --><link rel="stylesheet" href="../assets/css/app.min.css"><link rel="stylesheet" href="https://apps.bdimg.com/libs/fontawesome/4.4.0/css/font-awesome.css"><!-- link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css"--><!-- link rel="stylesheet" href="../assets/css/share.min.css" --><meta property="og:type" content="article"><meta property="og:title" content="time.h"><link rel="apple-touch-icon" href="../assets/icons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="192x192" href="../assets/icons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="../assets/icons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="../assets/icons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="../assets/icons/favicon-16x16.png"><link rel="manifest" href="../assets/icons/manifest.json"></head><body><nav class="navbar is-light" role="navigation" id="navbar" aria-label="main navigation"><div class="container"><div class="navbar-brand"><a href="/" class="navbar-item title has-text-grey has-text-weight-light is-5">网道 / WangDoc.com </a><a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false"><span aria-hidden="true"></span> <span aria-hidden="true"></span> <span aria-hidden="true"></span></a></div><div class="navbar-menu" id="navMenu"><div class="navbar-end"><div class="navbar-item"><form action="https://sourcegraph.com/search" target="_blank" method="get" onsubmit='this.q.value="repo:^github.com/wangdoc/clang-tutorial$ "+this.origin.value'><p class="control has-icons-right"><input class="input" type="text" name="origin" placeholder="搜索..."> <span class="icon is-small is-right"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path fill="#ddd" d="M23.822 20.88l-6.353-6.354c.93-1.465 1.467-3.2 1.467-5.059.001-5.219-4.247-9.467-9.468-9.467s-9.468 4.248-9.468 9.468c0 5.221 4.247 9.469 9.468 9.469 1.768 0 3.421-.487 4.839-1.333l6.396 6.396 3.119-3.12zm-20.294-11.412c0-3.273 2.665-5.938 5.939-5.938 3.275 0 5.94 2.664 5.94 5.938 0 3.275-2.665 5.939-5.94 5.939-3.274 0-5.939-2.664-5.939-5.939z"/></svg></span></p><input type="hidden" name="q" value=""> <input type="hidden" name="patternType" value="literal"></form></div><a class="navbar-item is-hidden-desktop-only" target="_blank" href="https://github.com/wangdoc/clang-tutorial"><span class="icon" style="color: #333;"><i class="fa fa-lg fa-github"></i></span></a></div></div></div></nav><section class="section main article"><div class="container"><div class="columns"><div class="column is-8 is-6-widescreen is-offset-1-widescreen"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="../index.html"><span class="icon"><i class="fa fa-home"></i></span> &nbsp;C 语言教程</a></li><li><a href="../lib/index.html">标准库</a></li><li class="is-active"><a class="has-text-grey" href="../lib/time.h.html">time.h</a></li></ul></nav><nav class="level level-previous-next is-mobile"><!-- Left side --><div class="level-left"><p class="level-item is-narrow"><a href="../lib/string.h.html"><span class="icon"><i class="fa fa-toggle-left"></i></span> string.h</a></p></div><div class="level-right"><p class="level-item is-narrow"><a href="../lib/wchar.h.html">wchar.h <span class="icon"><i class="fa fa-toggle-right"></i></span></a></p></div></nav><article class="content"><h1 class="title">time.h</h1><div class="page-meta"><p>网道（WangDoc.com），互联网文档计划</p></div><h2 id="time_t">time_t <a class="markdownIt-Anchor" href="#time_t">#</a></h2><p>time_t 是一个表示时间的类型别名，可以视为国际标准时 UTC。它可能是浮点数，也可能是整数，Unix 系统一般是整数。</p><p>许多系统上，time_t 表示自时间纪元（time epoch）以来的秒数。Unix 的时间纪元是国际标准时 UTC 的1970年1月1日的零分零秒。time_t 如果为负数，则表示时间纪元之前的时间。</p><p>time_t 一般是32位或64位整数类型的别名，具体类型取决于当前系统。如果是32位带符号整数，time_t 可以表示的时间到 2038年1月19日03:14:07 UTC 为止；如果是32位无符号整数，则表示到2106年。如果是64位带符号整数，可以表示<code>-2930</code>亿年到<code>+2930</code>亿年的时间范围。</p><h2 id="struct-tm">struct tm <a class="markdownIt-Anchor" href="#struct-tm">#</a></h2><p>struct tm 是一个数据结构，用来保存时间的各个组成部分，比如小时、分钟、秒、日、月、年等。下面是它的结构。</p><pre class="hljs"><code><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tm</span> {</span>
  <span class="hljs-type">int</span> tm_sec;    <span class="hljs-comment">// 秒数 [0, 60]</span>
  <span class="hljs-type">int</span> tm_min;    <span class="hljs-comment">// 分钟 [0, 59]</span>
  <span class="hljs-type">int</span> tm_hour;   <span class="hljs-comment">// 小时 [0, 23]</span>
  <span class="hljs-type">int</span> tm_mday;   <span class="hljs-comment">// 月份的天数 [1, 31]</span>
  <span class="hljs-type">int</span> tm_mon;    <span class="hljs-comment">// 月份 [0, 11]，一月用 0 表示</span>
  <span class="hljs-type">int</span> tm_year;   <span class="hljs-comment">// 距离 1900 的年数</span>
  <span class="hljs-type">int</span> tm_wday;   <span class="hljs-comment">// 星期几 [0, 6]，星期天用 0 表示</span>
  <span class="hljs-type">int</span> tm_yday;   <span class="hljs-comment">// 距离1月1日的天数 [0, 365]</span>
  <span class="hljs-type">int</span> tm_isdst;  <span class="hljs-comment">// 是否采用夏令时，1 表示采用，0 表示未采用</span>
};
</code></pre><h2 id="time">time() <a class="markdownIt-Anchor" href="#time">#</a></h2><p><code>time()</code>函数返回从时间纪元到现在经过的秒数。</p><pre class="hljs"><code><span class="hljs-type">time_t</span> <span class="hljs-title function_">time</span><span class="hljs-params">(<span class="hljs-type">time_t</span>* returned_value)</span>;
</code></pre><p><code>time()</code>接受一个 time_t 指针作为参数，返回值会写入指针地址。参数可以是空指针 NULL。</p><p><code>time()</code>的返回值是 time_t 类型的当前时间。 如果计算机无法提供当前的秒数，或者返回值太大，无法用<code>time_t</code>类型表示，<code>time()</code>函数就返回<code>-1</code>。</p><pre class="hljs"><code><span class="hljs-type">time_t</span> now;

<span class="hljs-comment">// 写法一    </span>
now = time(<span class="hljs-literal">NULL</span>);

<span class="hljs-comment">// 写法二    </span>
time(&amp;now);
</code></pre><p>上面示例展示了将当前时间存入变量<code>now</code>的两种写法。</p><p>如果要知道某个操作耗费的精确时间，需要调用两次<code>time()</code>，再将两次的返回值相减。</p><pre class="hljs"><code><span class="hljs-type">time_t</span> begin = time(<span class="hljs-literal">NULL</span>);

<span class="hljs-comment">// ... 执行某些操作</span>

<span class="hljs-type">time_t</span> end = time(<span class="hljs-literal">NULL</span>);

<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, end - begin);
</code></pre><p>注意，上面的方法只能精确到秒。</p><h2 id="ctime">ctime() <a class="markdownIt-Anchor" href="#ctime">#</a></h2><p><code>ctime()</code>用来将 time_t 类型的值直接输出为人类可读的格式。</p><pre class="hljs"><code><span class="hljs-type">char</span>* <span class="hljs-title function_">ctime</span><span class="hljs-params">( <span class="hljs-type">time_t</span> <span class="hljs-type">const</span> * time_value )</span>;
</code></pre><p><code>ctime()</code>的参数是一个 time_t 指针，返回一个字符串指针。该字符串的格式类似“Sun Jul 4 04:02:48 1976\n\0”，尾部包含换行符和字符串终止标志。</p><p>下面是一个例子。</p><pre class="hljs"><code><span class="hljs-type">time_t</span> now; 

now = time(<span class="hljs-literal">NULL</span>);

<span class="hljs-comment">// 输出 Sun Feb 28 18:47:25 2021</span>
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, ctime(&amp;now));
</code></pre><p>注意，<code>ctime()</code>会在字符串尾部自动添加换行符。</p><h2 id="localtimegmtime">localtime()，gmtime() <a class="markdownIt-Anchor" href="#localtimegmtime">#</a></h2><p><code>localtime()</code>函数用来将 time_t 类型的时间，转换为当前时区的 struct tm 结构。</p><p><code>gmtime()</code>函数用来将 time_t 类型的时间，转换为 UTC 时间的 struct tm 结构。</p><p>它们的区别就是返回值，前者是本地时间，后者是 UTC 时间。</p><pre class="hljs"><code><span class="hljs-keyword">struct</span> tm* <span class="hljs-title function_">localtime</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">time_t</span>* timer)</span>;
<span class="hljs-keyword">struct</span> tm* <span class="hljs-title function_">gmtime</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">time_t</span>* timer)</span>;
</code></pre><p>下面是一个例子。</p><pre class="hljs"><code><span class="hljs-type">time_t</span> now = time(<span class="hljs-literal">NULL</span>);

<span class="hljs-comment">// 输出 Local: Sun Feb 28 20:15:27 2021</span>
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Local: %s&quot;</span>, asctime(localtime(&amp;now)));

<span class="hljs-comment">// 输出 UTC  : Mon Mar  1 04:15:27 2021</span>
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;UTC  : %s&quot;</span>, asctime(gmtime(&amp;now)));
</code></pre><h2 id="asctime">asctime() <a class="markdownIt-Anchor" href="#asctime">#</a></h2><p><code>asctime()</code>函数用来将 struct tm 结构，直接输出为人类可读的格式。该函数会自动在输出的尾部添加换行符。</p><p>用法示例参考上一小节。</p><h2 id="mktime">mktime() <a class="markdownIt-Anchor" href="#mktime">#</a></h2><p><code>mktime()</code>函数用于把一个 struct tm 结构转换为 time_t 值。</p><pre class="hljs"><code><span class="hljs-type">time_t</span>　<span class="hljs-title function_">mktime</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> tm* tm_ptr)</span>;
</code></pre><p><code>mktime()</code>的参数是一个 struct tm 指针。</p><p><code>mktime()</code>会自动设置 struct tm 结构里面的<code>tm_wday</code>属性和<code>tm_yday</code>属性，开发者自己不必填写这两个属性。所以，这个函数常用来获得指定时间是星期几（<code>tm_wday</code>）。</p><p>struct tm 结构的<code>tm_isdst</code>属性也可以设为<code>-1</code>，让<code>mktime()</code>决定是否应该采用夏令时。</p><p>下面是一个例子。</p><pre class="hljs"><code><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tm</span> <span class="hljs-title">some_time</span> =</span> {
  .tm_year=<span class="hljs-number">82</span>,   <span class="hljs-comment">// 距离 1900 的年数</span>
  .tm_mon=<span class="hljs-number">3</span>,     <span class="hljs-comment">// 月份 [0, 11]</span>
  .tm_mday=<span class="hljs-number">12</span>,   <span class="hljs-comment">// 天数 [1, 31]</span>
  .tm_hour=<span class="hljs-number">12</span>,   <span class="hljs-comment">// 小时 [0, 23]</span>
  .tm_min=<span class="hljs-number">00</span>,    <span class="hljs-comment">// 分钟 [0, 59]</span>
  .tm_sec=<span class="hljs-number">04</span>,    <span class="hljs-comment">// 秒数 [0, 60]</span>
  .tm_isdst=<span class="hljs-number">-1</span>,  <span class="hljs-comment">// 夏令时</span>
};
    
<span class="hljs-type">time_t</span> some_time_epoch;
some_time_epoch = mktime(&amp;some_time);
    
<span class="hljs-comment">// 输出 Mon Apr 12 12:00:04 1982</span>
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, ctime(&amp;some_time_epoch));

<span class="hljs-comment">// 输出 Is DST: 0</span>
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Is DST: %d\n&quot;</span>, some_time.tm_isdst);
</code></pre><h2 id="difftime">difftime() <a class="markdownIt-Anchor" href="#difftime">#</a></h2><p><code>difftime()</code>用来计算两个时间之间的差异。Unix 系统上，直接相减两个 time_t 值，就可以得到相差的秒数，但是为了程序的可移植性，最好还是使用这个函数。</p><pre class="hljs"><code><span class="hljs-type">double</span> <span class="hljs-title function_">difftime</span><span class="hljs-params">( <span class="hljs-type">time_t</span> time1, <span class="hljs-type">time_t</span> time2 )</span>;
</code></pre><p><code>difftime()</code>函数接受两个 time_t 类型的时间作为参数，计算 time1 - time2 的差，并把结果转换为秒。</p><p>注意它的返回值是 double 类型。</p><pre class="hljs"><code><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;time.h&gt;</span></span>
    
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tm</span> <span class="hljs-title">time_a</span> =</span> {
    .tm_year=<span class="hljs-number">82</span>, 
    .tm_mon=<span class="hljs-number">3</span>,   
    .tm_mday=<span class="hljs-number">12</span>, 
    .tm_hour=<span class="hljs-number">4</span>,  
    .tm_min=<span class="hljs-number">00</span>,  
    .tm_sec=<span class="hljs-number">04</span>,  
    .tm_isdst=<span class="hljs-number">-1</span>,
  };
    
  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tm</span> <span class="hljs-title">time_b</span> =</span> {
    .tm_year=<span class="hljs-number">120</span>,
    .tm_mon=<span class="hljs-number">10</span>,  
    .tm_mday=<span class="hljs-number">15</span>, 
    .tm_hour=<span class="hljs-number">16</span>, 
    .tm_min=<span class="hljs-number">27</span>,  
    .tm_sec=<span class="hljs-number">00</span>,  
    .tm_isdst=<span class="hljs-number">-1</span>,
  };
    
  <span class="hljs-type">time_t</span> cal_a = mktime(&amp;time_a);
  <span class="hljs-type">time_t</span> cal_b = mktime(&amp;time_b);
    
  <span class="hljs-type">double</span> diff = difftime(cal_b, cal_a);
    
  <span class="hljs-type">double</span> years = diff / <span class="hljs-number">60</span> / <span class="hljs-number">60</span> / <span class="hljs-number">24</span> / <span class="hljs-number">365.2425</span>;
  
  <span class="hljs-comment">// 输出 1217996816.000000 seconds (38.596783 years) between events</span>
  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%f seconds (%f years) between events\n&quot;</span>, diff, years);
}
</code></pre><p>上面示例中，折算年份时，为了尽量准确，使用了一年的准确长度 365.2425 天，这样可以抵消闰年的影响。</p><h2 id="strftime">strftime() <a class="markdownIt-Anchor" href="#strftime">#</a></h2><p><code>strftime()</code>函数用来将 struct tm 结构转换为一个指定格式的字符串，并复制到指定地址。</p><pre class="hljs"><code><span class="hljs-type">size_t</span> <span class="hljs-title function_">strftime</span><span class="hljs-params">(
  <span class="hljs-type">char</span>* str, 
  <span class="hljs-type">size_t</span> maxsize, 
  <span class="hljs-type">const</span> <span class="hljs-type">char</span>* format, 
  <span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> tm* timeptr
)</span>
</code></pre><p><code>strftime()</code>接受四个参数。</p><ul><li>第一个参数：目标字符串的指针。</li><li>第二个参数：目标字符串可以接受的最大长度。</li><li>第三个参数：格式字符串。</li><li>第四个参数：struct tm 结构。</li></ul><p>如果执行成功（转换并复制），<code>strftime()</code>函数返回复制的字符串长度；如果执行失败，返回<code>-1</code>。</p><p>下面是一个例子。</p><pre class="hljs"><code><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;time.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
  <span class="hljs-type">char</span> s[<span class="hljs-number">128</span>];
  <span class="hljs-type">time_t</span> now = time(<span class="hljs-literal">NULL</span>);

  <span class="hljs-comment">// %c: 本地时间</span>
  strftime(s, <span class="hljs-keyword">sizeof</span> s, <span class="hljs-string">&quot;%c&quot;</span>, localtime(&amp;now));
  <span class="hljs-built_in">puts</span>(s);   <span class="hljs-comment">// Sun Feb 28 22:29:00 2021</span>

  <span class="hljs-comment">// %A: 完整的星期日期的名称</span>
  <span class="hljs-comment">// %B: 完整的月份名称</span>
  <span class="hljs-comment">// %d: 月份的天数</span>
  strftime(s, <span class="hljs-keyword">sizeof</span> s, <span class="hljs-string">&quot;%A, %B %d&quot;</span>, localtime(&amp;now));
  <span class="hljs-built_in">puts</span>(s);   <span class="hljs-comment">// Sunday, February 28</span>

  <span class="hljs-comment">// %I: 小时（12小时制）</span>
  <span class="hljs-comment">// %M: 分钟</span>
  <span class="hljs-comment">// %S: 秒数</span>
  <span class="hljs-comment">// %p: AM 或 PM</span>
  strftime(s, <span class="hljs-keyword">sizeof</span> s, <span class="hljs-string">&quot;It&#x27;s %I:%M:%S %p&quot;</span>, localtime(&amp;now));
  <span class="hljs-built_in">puts</span>(s);   <span class="hljs-comment">// It&#x27;s 10:29:00 PM</span>

  <span class="hljs-comment">// %F: ISO 8601 yyyy-mm-dd 格式</span>
  <span class="hljs-comment">// %T: ISO 8601 hh:mm:ss 格式</span>
  <span class="hljs-comment">// %z: ISO 8601 时区</span>
  strftime(s, <span class="hljs-keyword">sizeof</span> s, <span class="hljs-string">&quot;ISO 8601: %FT%T%z&quot;</span>, localtime(&amp;now));
  <span class="hljs-built_in">puts</span>(s);   <span class="hljs-comment">// ISO 8601: 2021-02-28T22:29:00-0800</span>
}
</code></pre><p>下面是常用的格式占位符。</p><ul><li>%%：输出 % 字符。</li><li>%a：星期几的简写形式，以当地时间计算。</li><li>%A：星期几的完整形式，以当地时间计算。</li><li>%b：月份的简写形式，以当地时间计算。</li><li>%B：月份的完整形式，以当地时间计算。</li><li>%c：日期和时间，使用“%x %X”。</li><li>%d：月份的天数（01-31）。</li><li>%H：小时，采用24小时制（00-23）。</li><li>%I：小时，采用12小时制（00-12）。</li><li>%J：一年的第几天（001-366）。</li><li>%m：月数（01-12）。</li><li>%M：分钟（00～59）。</li><li>%P：AM 或 PM。</li><li>%R：相当于&quot;%H:%M&quot;。</li><li>%S：秒（00-61）。</li><li>%U：一年的第几星期（00-53），以星期日为第1天。</li><li>%w：一星期的第几天，星期日为第0天。</li><li>%W：一年的第几星期(00-53)，以星期一为第1天。</li><li>%x：完整的年月日的日期，以当地时间计算。</li><li>%X：完整的时分秒的时间，以当地时间计算。</li><li>%y：两位数年份（00-99）。</li><li>%Y：四位数年份（例如 1984）。</li><li>%Z：时区的简写。</li></ul><h2 id="timespec_get">timespec_get() <a class="markdownIt-Anchor" href="#timespec_get">#</a></h2><p><code>timespec_get()</code>用来将当前时间转成距离时间纪元的纳秒数（十亿分之一秒）。</p><pre class="hljs"><code><span class="hljs-type">int</span> <span class="hljs-title function_">timespec_get</span> <span class="hljs-params">( <span class="hljs-keyword">struct</span> timespec* ts, <span class="hljs-type">int</span> base )</span> ;
</code></pre><p><code>timespec_get()</code>接受两个参数。</p><p>第一个参数是 struct timespec 结构指针，用来保存转换后的时间信息。struct timespec 的结构如下。</p><pre class="hljs"><code><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">timespec</span> {</span>
  <span class="hljs-type">time_t</span> tv_sec;   <span class="hljs-comment">// 秒数</span>
  <span class="hljs-type">long</span>   tv_nsec;  <span class="hljs-comment">// 纳秒</span>
};
</code></pre><p>第二个参数是一个整数，表示时间计算的起点。标准只给出了宏 TIME_UTC 这一个可能的值，表示返回距离时间纪元的秒数。</p><p>下面是一个例子。</p><pre class="hljs"><code><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">timespec</span> <span class="hljs-title">ts</span>;</span>
    
timespec_get(&amp;ts, TIME_UTC);
    
<span class="hljs-comment">// 1614581530 s, 806325800 ns</span>
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%ld s, %ld ns\n&quot;</span>, ts.tv_sec, ts.tv_nsec);
    
<span class="hljs-type">double</span> float_time = ts.tv_sec + ts.tv_nsec/<span class="hljs-number">1000000000.0</span>;

<span class="hljs-comment">// 1614581530.806326 seconds since epoch</span>
<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%f seconds since epoch\n&quot;</span>, float_time);
</code></pre><h2 id="clock">clock() <a class="markdownIt-Anchor" href="#clock">#</a></h2><p><code>clock()</code>函数返回从程序开始执行到当前的 CPU 时钟周期。一个时钟周期等于 CPU 频率的倒数，比如 CPU 的频率如果是 1G Hz，表示1秒内时钟信号可以变化 10^9 次，那么每个时钟周期就是 10^-9 秒。</p><pre class="hljs"><code><span class="hljs-type">clock_t</span>　<span class="hljs-title function_">clock</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>;
</code></pre><p><code>clock()</code>函数返回一个数字，表示从程序开始到现在的 CPU 时钟周期的次数。这个值的类型是 clock_t，一般是 long int 类型。</p><p>为了把这个值转换为秒，应该把它除以常量<code>CLOCKS_PER_SEC</code>（每秒的时钟周期），这个常量也由<code>time.h</code>定义。</p><pre class="hljs"><code><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;CPU time: %f\n&quot;</span>, clock() / (<span class="hljs-type">double</span>)CLOCKS_PER_SEC);
</code></pre><p>上面示例可以输出程序从开始到运行到这一行所花费的秒数。</p><p>如果计算机无法提供 CPU 时间，或者返回值太大，无法用<code>clock_t</code>类型表示，<code>clock()</code>函数就返回<code>-1</code>。</p><p>为了知道某个操作所耗费的精确时间，需要调用两次<code>clock()</code>，然后将两次的返回值相减。</p><pre class="hljs"><code><span class="hljs-type">clock_t</span> start = clock();

<span class="hljs-comment">// ... 执行某些操作</span>

<span class="hljs-type">clock_t</span> end = clock();

<span class="hljs-type">long</span> <span class="hljs-type">double</span> seconds = (<span class="hljs-type">float</span>)(end - start) / CLOCKS_PER_SEC;
</code></pre><h2 id="参考链接">参考链接 <a class="markdownIt-Anchor" href="#参考链接">#</a></h2><ul><li><a href="https://serhack.me/articles/measure-execution-time-program/" target="_blank" rel="noopener">How to Measure Execution Time of a Program</a></li></ul></article><nav class="level level-previous-next is-mobile"><!-- Left side --><div class="level-left"><p class="level-item is-narrow"><a href="../lib/string.h.html"><span class="icon"><i class="fa fa-toggle-left"></i></span> string.h</a></p></div><div class="level-right"><p class="level-item is-narrow"><a href="../lib/wchar.h.html">wchar.h <span class="icon"><i class="fa fa-toggle-right"></i></span></a></p></div></nav><div class="page-info"><p>本教程采用<a href="https://creativecommons.org/licenses/by-sa/3.0/deed.zh" target="_blank">知识共享 署名-相同方式共享 3.0协议</a>。</p><p>分享本文 <span class="social-share"></span></p></div></div><div class="column is-3 is-offset-1"><nav class="panel panel-menu"><p class="panel-heading"><i class="fa fa-book" aria-hidden="true"></i> C 语言教程</p><div class="panel-block"><aside class="menu"><p class="menu-label"></p><ul class="menu-list"><li><a href="../intro.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">简介</span></a></li><li><a href="../syntax.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">基本语法</span></a></li><li><a href="../variable.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">变量</span></a></li><li><a href="../operator.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">运算符</span></a></li><li><a href="../flow-control.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">流程控制</span></a></li><li><a href="../types.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">数据类型</span></a></li><li><a href="../pointer.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">指针</span></a></li><li><a href="../function.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">函数</span></a></li><li><a href="../array.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">数组</span></a></li><li><a href="../string.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">字符串</span></a></li><li><a href="../memory.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">内存管理</span></a></li><li><a href="../struct.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">struct 结构</span></a></li><li><a href="../typedef.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">typedef 命令</span></a></li><li><a href="../union.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">Union 结构</span></a></li><li><a href="../enum.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">Enum 类型</span></a></li><li><a href="../preprocessor.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">预处理器</span></a></li><li><a href="../io.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">I/O 函数</span></a></li><li><a href="../file.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">文件操作</span></a></li><li><a href="../specifier.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">变量说明符</span></a></li><li><a href="../multifile.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">多文件项目</span></a></li><li><a href="../cli.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">命令行环境</span></a></li><li><a href="../multibyte.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">多字节字符</span></a></li><li><a href="../lib/index.html"><span class="icon"><i class="fa fa-caret-down"></i> </span><i class="fa folder fa-folder-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">标准库</span></a><ul><li><a href="../lib/assert.h.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">assert.h</span></a></li><li><a href="../lib/ctype.h.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">ctype.h</span></a></li><li><a href="../lib/errno.h.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">errno.h</span></a></li><li><a href="../lib/float.h.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">float.h</span></a></li><li><a href="../lib/inttypes.h.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">inttypes.h</span></a></li><li><a href="../lib/iso646.h.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">iso646.h</span></a></li><li><a href="../lib/limits.h.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">limits.h</span></a></li><li><a href="../lib/locale.h.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">locale.h</span></a></li><li><a href="../lib/math.h.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">math.h</span></a></li><li><a href="../lib/signal.h.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">signal.h</span></a></li><li><a href="../lib/stdint.h.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">stdint.h</span></a></li><li><a href="../lib/stdlib.h.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">stdlib.h</span></a></li><li><a href="../lib/stdio.h.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">stdio.h</span></a></li><li><a href="../lib/string.h.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">string.h</span></a></li><li><a href="../lib/time.h.html" class="is-active"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">time.h</span></a></li><li><a href="../lib/wchar.h.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">wchar.h</span></a></li><li><a href="../lib/wctype.h.html"><span class="icon"></span> <i class="fa fa-file-text-o" aria-hidden="true" style="width: 14px;"></i> &nbsp; <span class="menu-list-title">wctype.h</span></a></li></ul></li></ul></aside></div></nav><nav class="panel panel-info"><p class="panel-heading"><i class="fa fa-link" aria-hidden="true"></i> 链接</p><div class="panel-block"><aside class="menu"><p class="menu-label"></p><ul class="menu-list"><li><a href="https://raw.githubusercontent.com/wangdoc/clang-tutorial/master/docs/lib/time.h.md" target="_blank"><span class="icon"></span><i class="fa fa-code" aria-hidden="true" style="width: 14px;"></i>&nbsp;本文源码</a></li><li><a href="https://github.com/wangdoc/clang-tutorial" target="_blank"><span class="icon"></span><i class="fa fa-hdd-o" aria-hidden="true" style="width: 14px;"></i>&nbsp;代码仓库</a></li><li><a href="https://github.com/wangdoc/clang-tutorial/issues" target="_blank"><span class="icon"></span><i class="fa fa-flag-o" aria-hidden="true" style="width: 14px;"></i>&nbsp;反馈</a></li></ul></aside></div></nav></div></div><div class="columns"><div class="column is-8 is-6-widescreen is-offset-1-widescreen"><div id="disqus_thread"></div></div></div></div></section><footer class="footer"><div class="container"><div class="content has-text-centered"><p>联系：contact@wangdoc.com</p></div></div></footer><script>var LOPPO={current_path:"lib/time.h.md",relative_root_path:"../",article_toc:'<ul class="markdownIt-TOC">\n<li><a href="#time_t">time_t</a></li>\n<li><a href="#struct-tm">struct tm</a></li>\n<li><a href="#time">time()</a></li>\n<li><a href="#ctime">ctime()</a></li>\n<li><a href="#localtimegmtime">localtime()，gmtime()</a></li>\n<li><a href="#asctime">asctime()</a></li>\n<li><a href="#mktime">mktime()</a></li>\n<li><a href="#difftime">difftime()</a></li>\n<li><a href="#strftime">strftime()</a></li>\n<li><a href="#timespec_get">timespec_get()</a></li>\n<li><a href="#clock">clock()</a></li>\n<li><a href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5">参考链接</a></li>\n</ul>\n'}</script><script src="../assets/js/app.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-111269443-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-111269443-1")</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?5eec262881855af3dede6a71234571f6",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}()</script><script>var disqus_config=function(){var t=window.location,e=t.protocol+"//"+t.host+(t.port?":"+t.port:"")+t.pathname;this.page.url=e,this.page.identifier=t.pathname};!function(){var t=document,e=t.createElement("script");e.src="https://wangdoc-clang.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><!--script src="../assets/js/social-share.min.js"--><!--/script--><script>var shareDesc="我正在阅读《time.h》，出自网道（WangDoc.com）的《C 语言教程》。",shareOpts={url:window.location.href,source:shareDesc,title:shareDesc,description:"",image:"",sites:["weibo","wechat","qq","qzone","twitter","facebook"],origin:"WangDoc_com",disabled:[],wechatQrcodeTitle:"微信",wechatQrcodeHelper:"扫一下二维码，分享到微信。"};socialShare(".social-share",shareOpts)</script></body></html>