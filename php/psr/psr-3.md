---
title: 日志接口
titleTemplate: PSR 教程
---

# 日志接口

本文制定了日志类库的通用接口规范。

本规范的主要目的，是为了让日志类库以简单通用的方式，通过接收一个 Psr\Log\LoggerInterface 对象，来记录日志信息。 框架以及 CMS 内容管理系统如有需要，可以 对此接口进行扩展，但需遵循本规范，这才能保证在使用第三方的类库文件时，日志接口仍能正常对接。

本文档中的 `implementor` 一词应理解为在日志的库中实现 `LoggerInterface` 的人。记录器的调用者称为 `user`

## 1. 规范

### 1.1 基础知识

> `LoggerInterface` 接口对外定义了八个方法，分别用来记录 RFC 5424 中定义的八个等级的日志：

| 级别      | 中文 | 严重程度描述     | code |
| --------- | ---- | ---------------- | ---- |
| emergency | 紧急 | 系统无法使用     | 0    |
| alert     | 警报 | 必须立即采取行动 | 1    |
| critical  | 严重 | 临界条件         | 2    |
| error     | 错误 | 错误条件         | 3    |
| warning   | 警告 | 警告条件         | 4    |
| notice    | 通知 | 正常但重要的条件 | 5    |
| info      | 信息 | 信息性消息       | 6    |
| debug     | 调试 | 调试级消息       | 7    |

::: tip 第九个方法 - log
第 1 个参数为记录的等级。可使用 1 个预先定义的等级常量作为参数来调用此方法， `必须` 与直接调用以上八个方法具有相同的效果。如果传入的等级常量参数没有预先定义，则 `必须` 抛出 `Psr\Log\InvalidArgumentException` 类型的异常。在不确定的情况下，使用者 `不该` 使用未支持的等级常量来调用此方法。
:::

### 1.2 消息

以上每个方法都接受一个字符串类型或者是有 `__toString()` 方法的对象作为记录信息参数，这样，实现者就能把它当成字符串来处理，否则实现者 `必须` 自己把它转换成字符串。

记录信息参数 `可以` 携带占位符，实现者 `可以` 根据上下文将其它替换成相应的值。

其中占位符 `必须` 与上下文数组中的键名保持一致。

占位符的名称 `必须` 由一个左花括号 { 以及一个右括号 } 包含。但花括号与名称之间 一定不可有空格符。

占位符的名称 `应该` 只由 `A-Z`、`a-z`、`0-9`、下划线 `_`、以及英文的句号 `.` 组成，其它字符作为将来占位符规范的保留。

实现者 `可以` 通过对占位符采用不同的转义和转换策略，来生成最终的日志。

而使用者在不知道上下文的前提下，`不该` 提前转义占位符。

以下是一个占位符使用的例子：

<<<@/assets/php/psr/psr-3/01.php
